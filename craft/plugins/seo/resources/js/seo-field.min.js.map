{"version":3,"file":"seo-field.min.js","sources":["../../../resources/js/seo-field.js"],"sourcesContent":["/* global Craft, Garnish, $, module, define */\n\nconst SeoField = function (namespace, hasSection) {\n\tif (window.hasSeoField) return;\n\t\n\twindow.hasSeoField = true;\n\n\tthis.namespace = namespace;\n\n\t// Field\n\tdocument.getElementById(namespace + '-field').addEventListener('DOMNodeRemoved', function () {\n\t\twindow.hasSeoField = false;\n\t});\n\n\t// Snippet\n\tthis.title();\n\tthis.slug();\n\tthis.desc();\n\n\tif (hasSection) {\n\n\t\tthis.getHTMLForParsing = new SeoField.GetEntryHTML();\n\n\t\t// Keyword\n\t\tthis.keyword = document.getElementById(namespace + '-keyword');\n\n\t\t// Score\n\t\tthis.score = document.getElementById(namespace + \"-score\");\n\t\tthis.list = document.getElementById(namespace + \"-list\");\n\t\tthis.bar = document.getElementById(namespace + \"-bar\");\n\t\tthis.scoreField = document.getElementById(namespace + \"-score-field\");\n\t\tthis.toggle();\n\n\t\t// Calculate\n\t\tthis.calculateScore();\n\n\t\t// Re-calculate the score every second\n\t\tsetInterval(() => {\n\t\t\tthis.calculateScore();\n\t\t}, 1000);\n\n\t}\n};\n\n// SNIPPET\nSeoField.prototype.title = function () {\n\tconst title = this.titleField = document.getElementById(this.namespace + '-title')\n\t\t, t = document.getElementById('title');\n\tlet tInput, titleInput, initial;\n\n\ttInput = function () {\n\t\ttitle.value = this.value + ' ' + initial;\n\t};\n\n\ttitleInput = function () {\n\t\tthis.classList.remove('clean');\n\t\tt.removeEventListener('input', tInput, false);\n\t\tthis.removeEventListener('input', titleInput, false);\n\t};\n\n\tif (t && title.classList.contains('clean')) {\n\t\tinitial = title.value;\n\t\tt.addEventListener('input', tInput, false);\n\t}\n\n\ttitle.addEventListener('input', titleInput, false);\n\n\ttitle.addEventListener('change', () => { this.calculateScore(); });\n};\n\nSeoField.prototype.slug = function () {\n\tconst slug = this.slugField = document.getElementById(this.namespace + '-slug')\n\t\t, s = document.getElementById('slug');\n\n\tif (s && slug) {\n\t\tslug.textContent = s.value;\n\n\t\t// On a loop because crafts slug generation doesn't trigger any events\n\t\tsetInterval(() => {\n\t\t\tif (slug.textContent !== s.value) {\n\t\t\t\tslug.textContent = s.value;\n\t\t\t\tthis.calculateScore();\n\t\t\t}\n\t\t}, 1000);\n\t}\n};\n\nSeoField.prototype.desc = function () {\n\tconst desc = this.descField = document.getElementById(this.namespace + '-description');\n\n\tfunction adjustHeight () {\n\t\tsetTimeout(function () {\n\t\t\tdesc.oninput();\n\t\t}, 1);\n\t}\n\n\t// Set Initial Height\n\tadjustHeight();\n\n\t// Set height on tab change (needed if the field is in a separate tab)\n\tif (document.getElementById('tabs')) {\n\t\t[].slice.call(document.querySelectorAll('#tabs a.tab')).forEach(function (el) {\n\t\t\tel.addEventListener('click', function () {\n\t\t\t\tadjustHeight();\n\t\t\t});\n\t\t});\n\t}\n\n\tif (Craft.livePreview) {\n\t\tCraft.livePreview.on('enter', adjustHeight);\n\t\tCraft.livePreview.on('exit', adjustHeight);\n\t}\n\twindow.addEventListener('resize', adjustHeight);\n\n\t// Disable line breaks\n\tdesc.addEventListener('keydown', function (e) {\n\t\tif (e.keyCode === 13) e.preventDefault();\n\t});\n\n\t// Cleanse line breaks and check length\n\tdesc.addEventListener('input', function () {\n\t\tthis.value = this.value.replace(/(\\r\\n|\\n|\\r)/gm,\" \");\n\t\tif (this.value.length > 160) this.classList.add('invalid');\n\t\telse this.classList.remove('invalid');\n\t});\n\n\tdesc.addEventListener('change', () => { this.calculateScore(); });\n};\n\n// SCORE\nSeoField.prototype.toggle = function () {\n\tlet isOpen = false;\n\n\tthis.score.getElementsByClassName('toggle-score')[0].addEventListener('click', () => {\n\t\tthis.score.classList.toggle('open');\n\t\tisOpen = !isOpen;\n\n\t\tif (isOpen) {\n\t\t\tthis.score.getElementsByClassName('details')[0].style.height = this.score.getElementsByClassName('details-inner')[0].clientHeight + 'px';\n\t\t} else {\n\t\t\tthis.score.getElementsByClassName('details')[0].style.height = '';\n\t\t}\n\t});\n\n\tthis.toggle.close = () => {\n\t\tthis.score.classList.remove('open');\n\t\tisOpen = false;\n\t\tthis.score.getElementsByClassName('details')[0].style.height = '';\n\t};\n};\n\nSeoField.prototype.calculateScore = function () {\n\tif (this.keyword && this.keyword.value) {\n\t\tthis.currentScore = {};\n\n\t\tthis.currentScore.titleLength = this.judgeTitleLength();\n\t\tthis.currentScore.titleKeyword = this.judgeTitleKeyword();\n\t\tthis.currentScore.slug = this.judgeSlug();\n\t\tthis.currentScore.desc = this.judgeDesc();\n\n\t\tthis.getHTMLForParsing.update((content) => {\n\t\t\tif (content.textContent.replace('\\r', '').replace('\\n', '').replace('\\r\\n', '').replace(/\\s+/gi, '') === '') {\n\t\t\t\tthis.currentScore.noContent = {\n\t\t\t\t\tscore: SeoField.Levels.BAD,\n\t\t\t\t\treason: 'You have no content, adding some would be a good start!'\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tthis.content = content;\n\t\t\t\tthis.content.textOnly = this.content.textContent.replace('\\r', ' ').replace('\\n', ' ').replace('\\r\\n', ' ').replace(/\\s+/gi, ' ');\n\t\t\t\tthis.content.stats = SeoField.TextStatistics(this.content.textContent);\n\n\t\t\t\tthis.currentScore.wordCount = this.judgeWordCount();\n\t\t\t\tthis.currentScore.firstParagraph = this.judgeFirstParagraph();\n\t\t\t\tthis.currentScore.images = this.judgeImages();\n\t\t\t\tthis.currentScore.links = this.judgeLinks();\n\t\t\t\tthis.currentScore.headings = this.judgeHeadings();\n\t\t\t\tthis.currentScore.density = this.judgeDensity();\n\t\t\t\tthis.currentScore.fleschEase = this.judgeFleschEase();\n\t\t\t}\n\n\t\t\tthis.getHTMLForParsing.clean();\n\t\t\tthis.updateScoreHtml();\n\t\t});\n\t} else {\n\t\tthis.toggle.close();\n\t\tthis.score.classList.add('disabled');\n\t\tthis.scoreField.value = '';\n\t}\n};\n\nSeoField.prototype.updateScoreHtml = function () {\n\tthis.score.classList.remove('disabled');\n\n\tconst sorted = SeoField.sortScore(this.currentScore);\n\tconst sortedScore = sorted.merged;\n\n\tthis.list.innerHTML = '';\n\tfor (let i = 0; i < sortedScore.length; i++) {\n\t\tconst j = sortedScore[i];\n\t\tthis.list.innerHTML += '<li class=\"'+ j.score+'\">' + j.reason + '</li>';\n\t}\n\n\tconst good = this.bar.getElementsByClassName('good')[0]\n\t\t, ok = this.bar.getElementsByClassName('ok')[0]\n\t\t, bad = this.bar.getElementsByClassName('bad')[0];\n\n\tconst goodW = 1 - ((sortedScore.length - sorted.good.length) / sortedScore.length)\n\t\t, okW = 1 - ((sortedScore.length - sorted.ok.length) / sortedScore.length)\n\t\t, badW = 1 - ((sortedScore.length - sorted.bad.length) / sortedScore.length);\n\n\tgood.style.transform = 'scale(' + goodW + ', 1)';\n\tok.style.transform = 'translateX(' + (goodW * 100) + '%) scale(' + okW + ', 1)';\n\tbad.style.transform = 'translateX(' + ((goodW + okW) * 100) + '%) scale(' + badW + ', 1)';\n\n\tlet s = '';\n\n\tif (badW > goodW) {\n\t\ts = 'bad';\n\t} else if ((badW + okW) > goodW) {\n\t\ts = 'ok';\n\t} else {\n\t\ts = 'good';\n\t}\n\n\tthis.scoreField.value = s;\n};\n\n// CALCULATOR\nSeoField.prototype.judgeTitleLength = function () {\n\tconst v = this.titleField.value;\n\t\n\tlet ret = {\n\t\tscore : (v.length < 40 || v.length > 60) ? SeoField.Levels.BAD : SeoField.Levels.GOOD,\n\t\treason: (v.length < 40) ? SeoField.Reasons.titleLengthFailMin : (v.length > 60) ? SeoField.Reasons.titleLengthFailMax : SeoField.Reasons.titleLengthSuccess\n\t};\n\tret.reason = ret.reason.replace('{l}', v.length);\n\n\treturn ret;\n};\n\nSeoField.prototype.judgeTitleKeyword = function () {\n\tlet ret;\n\tconst index = this.titleField.value.toLowerCase().indexOf(this.keyword.value.toLowerCase());\n\n\tif (index > -1) {\n\t\tif (index <= this.titleField.value.length * 0.3) {\n\t\t\tret = {\n\t\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\t\treason: SeoField.Reasons.titleKeywordSuccess\n\t\t\t};\n\t\t} else {\n\t\t\tret = {\n\t\t\t\tscore : SeoField.Levels.OK,\n\t\t\t\treason: SeoField.Reasons.titleKeywordPosFail\n\t\t\t};\n\t\t}\n\t} else {\n\t\tret = {\n\t\t\tscore : SeoField.Levels.BAD,\n\t\t\treason: SeoField.Reasons.titleKeywordFail\n\t\t};\n\t}\n\n\treturn ret;\n};\n\nSeoField.prototype.judgeSlug = function () {\n\tif (!this.slugField) return;\n\n\tconsole.log(this.keyword.value.toLowerCase().replace(/[^a-zA-Z0-9-_]/g, ''));\n\tif (this.slugField.textContent.toLowerCase().indexOf(this.keyword.value.toLowerCase().replace(/[^a-zA-Z0-9-_]/g, '')) > -1) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\treason: SeoField.Reasons.slugSuccess\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.BAD,\n\t\t\treason: SeoField.Reasons.slugFail\n\t\t};\n\t}\n};\n\n// TODO: Check if keyword in first half / number of times it appears?\nSeoField.prototype.judgeDesc = function () {\n\tif (this.descField.value.toLowerCase().indexOf(this.keyword.value.toLowerCase()) > -1) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\treason: SeoField.Reasons.descSuccess\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.BAD,\n\t\t\treason: SeoField.Reasons.descFail\n\t\t};\n\t}\n};\n\nSeoField.prototype.judgeWordCount = function () {\n\tvar wc = this.content.stats.wordCount();\n\tif (wc > 300) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\treason: SeoField.Reasons.wordCountSuccess.replace('{l}', wc)\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.BAD,\n\t\t\treason: SeoField.Reasons.wordCountFail.replace('{l}', wc)\n\t\t};\n\t}\n};\n\nSeoField.prototype.judgeFirstParagraph = function () {\n\tif (this.content.querySelector('p') && this.content.querySelector('p').textContent.toLowerCase().indexOf(this.keyword.value.toLowerCase()) > -1) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\treason: SeoField.Reasons.firstParagraphSuccess\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.BAD,\n\t\t\treason: SeoField.Reasons.firstParagraphFail\n\t\t};\n\t}\n};\n\nSeoField.prototype.judgeImages = function () {\n\tconst imgs = this.content.getElementsByTagName('img');\n\tif (imgs) {\n\t\tlet imgsWithAltKeyword = 0;\n\n\t\tfor (let i = 0; i < imgs.length; i++) {\n\t\t\tif (imgs[i].getAttribute('alt') &&\n\t\t\t\timgs[i].getAttribute('alt').toLowerCase().indexOf(this.keyword.value.toLowerCase()))\n\t\t\t\timgsWithAltKeyword++;\n\t\t}\n\n\t\tif (imgsWithAltKeyword === imgs.length) {\n\t\t\treturn {\n\t\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\t\treason: SeoField.Reasons.imagesSuccess\n\t\t\t};\n\t\t} else if (imgsWithAltKeyword >= imgs.length/2) {\n\t\t\treturn {\n\t\t\t\tscore : SeoField.Levels.OK,\n\t\t\t\treason: SeoField.Reasons.imagesOk\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tscore : SeoField.Levels.BAD,\n\t\t\t\treason: SeoField.Reasons.imagesFail\n\t\t\t};\n\t\t}\n\t}\n};\n\nSeoField.prototype.judgeLinks = function () {\n\tconst a = this.content.getElementsByTagName('a');\n\n\tif (a) {\n\t\tfor (let i = 0; i < a.length; i++) {\n\t\t\tif (SeoField.isExternalUrl(a[i].href)) {\n\t\t\t\treturn {\n\t\t\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\t\t\treason: SeoField.Reasons.linksSuccess\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\tscore : SeoField.Levels.BAD,\n\t\treason: SeoField.Reasons.linksFail\n\t};\n};\n\nSeoField.prototype.judgeHeadings = function () {\n\tconst headings = this.content.querySelectorAll('h1,h2,h3,h4,h5,h6');\n\n\tif (headings) {\n\t\tlet primary = 0, secondary = 0;\n\n\t\tfor (let i = 0; i < headings.length; i++) {\n\t\t\tif (headings[i].textContent.toLowerCase().indexOf(this.keyword.value.toLowerCase()) > -1) {\n\t\t\t\tif (['H1', 'H2'].indexOf(headings[i].nodeName) > -1) {\n\t\t\t\t\tprimary++;\n\t\t\t\t} else {\n\t\t\t\t\tsecondary++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (primary > 0) {\n\t\t\treturn {\n\t\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\t\treason: SeoField.Reasons.headingsSuccess\n\t\t\t};\n\t\t} else if (secondary > 0) {\n\t\t\treturn {\n\t\t\t\tscore : SeoField.Levels.OK,\n\t\t\t\treason: SeoField.Reasons.headingsOk\n\t\t\t};\n\t\t}\n\t}\n\n\treturn {\n\t\tscore : SeoField.Levels.BAD,\n\t\treason: SeoField.Reasons.headingsFail\n\t};\n};\n\nSeoField.prototype.judgeDensity = function () {\n\tconst words = this.content.stats.words();\n\n\tfunction countInArray (arr, word) {\n\t\tlet c = 0, i = 0;\n\t\tfor (; i < arr.length; i++)\n\t\t\tif (arr[i].toLowerCase() === word) c++;\n\t\treturn c;\n\t}\n\n\tconst keyCount = countInArray(words, this.keyword.value.toLowerCase());\n\n\tconst keyPercent = parseFloat((100 + ((keyCount - words.length) / words.length) * 100).toFixed(2));\n\n\tif (keyPercent < 1.0) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.BAD,\n\t\t\treason: SeoField.Reasons.densityFailUnder.replace('{d}', keyPercent)\n\t\t};\n\t} else if (keyPercent <= 2.5) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\treason: SeoField.Reasons.densitySuccess.replace('{d}', keyPercent)\n\t\t};\n\t} else if (keyPercent > 2.5) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.OK,\n\t\t\treason: SeoField.Reasons.densityOk.replace('{d}', keyPercent).replace('{c}', keyCount)\n\t\t};\n\t}\n\n\treturn {\n\t\tscore : SeoField.Levels.BAD,\n\t\treason: SeoField.Reasons.densityFail\n\t};\n};\n\nSeoField.prototype.judgeFleschEase = function () {\n\tconst level = this.content.stats.fleschKincaidReadingEase();\n\n\tif (level >= 80) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\treason: SeoField.Reasons.fleschSuccess.replace('{l}', level)\n\t\t};\n\t} else if (level >= 60) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.OK,\n\t\t\treason: SeoField.Reasons.fleschOk.replace('{l}', level)\n\t\t};\n\t}\n\n\treturn {\n\t\tscore : SeoField.Levels.BAD,\n\t\treason: SeoField.Reasons.fleschFail.replace('{l}', level)\n\t};\n};\n\n// HELPERS\nSeoField.Fail = function (message) {\n\tCraft.cp.displayError('<strong>SEO:</strong> ' + message);\n\tif (window.console) console.error.apply(console, ['%cSEO: %c' + message, 'font-weight:bold;','font-weight:normal;']); // eslint-disable-line no-console\n};\n\n/**\n * Get Parsed Fields HTML\n */\nSeoField.GetEntryHTML = function () {\n\tthis.clean();\n};\n\nSeoField.GetEntryHTML.prototype.update = function (cb) {\n\tconst postData = Garnish.getPostData(document.getElementById('container'));\n\n\tif (typeof Craft.livePreview === typeof undefined) {\n\t\tthis.score.previousElementSibling.classList.add('hide');\n\t\treturn;\n\t}\n\n\tif (!this.lastPostData || !Craft.compare(postData, this.lastPostData)) {\n\t\tthis.lastPostData = postData;\n\n\t\t$.ajax({\n\t\t\turl: Craft.livePreview.previewUrl,\n\t\t\tmethod: 'POST',\n\t\t\tdata: $.extend({}, postData, Craft.livePreview.basePostData),\n\t\t\txhrFields: {\n\t\t\t\twithCredentials: true\n\t\t\t},\n\t\t\tcrossDomain: true,\n\t\t\tsuccess: (data) => {\n\t\t\t\tdata = data.replace(/<script([^'\"]|\"(\\\\.|[^\"\\\\])*\"|'(\\\\.|[^'\\\\])*')*?<\\/script>/g, '');\n\n\t\t\t\tthis.iframe.contentWindow.document.open();\n\t\t\t\tthis.iframe.contentWindow.document.write(data);\n\t\t\t\tthis.iframe.contentWindow.document.close();\n\n\t\t\t\tif (this.iframe.contentWindow.document.body)\n\t\t\t\t\tcb(this.iframe.contentWindow.document.body);\n\t\t\t\telse\n\t\t\t\t\tSeoField.Fail(\"Unable to calculate score\");\n\t\t\t}\n\t\t});\n\t}\n};\n\nSeoField.GetEntryHTML.prototype.clean = function () {\n\tif (this.iframe)\n\t\tdocument.body.removeChild(this.iframe);\n\n\tthis.iframe = document.createElement('iframe');\n\tthis.iframe.setAttribute('frameborder', '0');\n\tthis.iframe.style.width = '0px';\n\tthis.iframe.style.height = '0px';\n\tdocument.body.appendChild(this.iframe);\n};\n\n/**\n * External URL checker\n * From http://stackoverflow.com/a/9744104/550109\n *\n * @param {string} url\n */\nSeoField.isExternalUrl = (function(){\n\tconst domainRe = /https?:\\/\\/((?:[\\w\\d]+\\.)+[\\w\\d]{2,})/i;\n\tlet res = null;\n\n\treturn function(url) {\n\t\tfunction domain(url) {\n\t\t\treturn (res = domainRe.exec(url)) !== null ? res[1] : false;\n\t\t}\n\n\t\treturn domain(location.href) !== domain(url);\n\t};\n})();\n\n/**\n * Organize the judgements by score\n *\n * @param unsorted\n * @returns {{good: Array, ok: Array, bad: Array, merged: Array.<T>}}\n */\nSeoField.sortScore = function (unsorted) {\n\tconst good = [], ok = [], bad = [];\n\tfor (let key in unsorted) {\n\t\tif (unsorted.hasOwnProperty(key) && unsorted[key]) {\n\t\t\tunsorted[key].key = key;\n\t\t\tswitch (unsorted[key].score) {\n\t\t\t\tcase SeoField.Levels.BAD:\n\t\t\t\t\tbad.push(unsorted[key]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase SeoField.Levels.OK:\n\t\t\t\t\tok.push(unsorted[key]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase SeoField.Levels.GOOD:\n\t\t\t\t\tgood.push(unsorted[key]);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\tgood: good,\n\t\tok: ok,\n\t\tbad: bad,\n\t\tmerged: good.concat(ok.concat(bad))\n\t};\n};\n\n/**\n * TextStatistics.js\n * Christopher Giffard (2012)\n * 1:1 API Fork of TextStatistics.php by Dave Child (Thanks mate!)\n * https://github.com/DaveChild/Text-Statistics\n *\n * Modified by Tam<hi@tam.sx>\n */\n(function(glob) {\n\n\tfunction cleanText(text) {\n\t\t// all these tags should be preceeded by a full stop.\n\t\tconst fullStopTags = ['li', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'dd'];\n\n\t\tfullStopTags.forEach(function(tag) {\n\t\t\ttext = text.replace(\"</\" + tag + \">\",\".\");\n\t\t});\n\n\t\ttext = text\n\t\t\t.replace(/<[^>]+>/g, \"\")\t\t\t\t// Strip tags\n\t\t\t.replace(/[,:;()\\-]/, \" \")\t\t\t\t// Replace commas, hyphens etc (count them as spaces)\n\t\t\t.replace(/’/g, \"'\")                     // Replace ’ with '\n\t\t\t.replace(/[\\.!?]/, \".\")\t\t\t\t\t// Unify terminators\n\t\t\t.replace(/^\\s+/,\"\")\t\t\t\t\t\t// Strip leading whitespace\n\t\t\t.replace(/[ ]*(\\n|\\r\\n|\\r)[ ]*/,\" \")\t// Replace new lines with spaces\n\t\t\t.replace(/([\\.])[\\. ]+/,\".\")\t\t\t// Check for duplicated terminators\n\t\t\t.replace(/[ ]*([\\.])/,\". \")\t\t\t\t// Pad sentence terminators\n\t\t\t.replace(/\\s+/,\" \")\t\t\t\t\t\t// Remove multiple spaces\n\t\t\t.replace(/\\s+$/,\"\");\t\t\t\t\t// Strip trailing whitespace\n\n\t\ttext += \".\"; // Add final terminator, just in case it's missing.\n\n\t\treturn text;\n\t}\n\n\tconst TextStatistics = function TextStatistics(text) {\n\t\tthis.text = text ? cleanText(text) : this.text;\n\t};\n\n\tTextStatistics.prototype.fleschKincaidReadingEase = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn Math.round((206.835 - (1.015 * this.averageWordsPerSentence(text)) - (84.6 * this.averageSyllablesPerWord(text)))*10)/10;\n\t};\n\n\tTextStatistics.prototype.fleschKincaidGradeLevel = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn Math.round(((0.39 * this.averageWordsPerSentence(text)) + (11.8 * this.averageSyllablesPerWord(text)) - 15.59)*10)/10;\n\t};\n\n\tTextStatistics.prototype.gunningFogScore = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn Math.round(((this.averageWordsPerSentence(text) + this.percentageWordsWithThreeSyllables(text, false)) * 0.4)*10)/10;\n\t};\n\n\tTextStatistics.prototype.colemanLiauIndex = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn Math.round(((5.89 * (this.letterCount(text) / this.wordCount(text))) - (0.3 * (this.sentenceCount(text) / this.wordCount(text))) - 15.8 ) *10)/10;\n\t};\n\n\tTextStatistics.prototype.smogIndex = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn Math.round(1.043 * Math.sqrt((this.wordsWithThreeSyllables(text) * (30 / this.sentenceCount(text))) + 3.1291)*10)/10;\n\t};\n\n\tTextStatistics.prototype.automatedReadabilityIndex = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn Math.round(((4.71 * (this.letterCount(text) / this.wordCount(text))) + (0.5 * (this.wordCount(text) / this.sentenceCount(text))) - 21.43)*10)/10;\n\t};\n\n\tTextStatistics.prototype.textLength = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn text.length;\n\t};\n\n\tTextStatistics.prototype.letterCount = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\ttext = text.replace(/[^a-z]+/ig,\"\");\n\t\treturn text.length;\n\t};\n\n\tTextStatistics.prototype.sentenceCount = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\n\t\t// Will be tripped up by \"Mr.\" or \"U.K.\". Not a major concern at this point.\n\t\treturn text.replace(/[^\\.!?]/g, '').length || 1;\n\t};\n\n\tTextStatistics.prototype.wordCount = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn text.split(/[^a-z0-9']+/i).length || 1;\n\t};\n\n\tTextStatistics.prototype.words = function () {\n\t\tif (this._words) return this._words;\n\t\treturn this._words = this.text.split(/[^a-z0-9']+/i); // jshint ignore:line\n\t};\n\n\tTextStatistics.prototype.averageWordsPerSentence = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn this.wordCount(text) / this.sentenceCount(text);\n\t};\n\n\tTextStatistics.prototype.averageSyllablesPerWord = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\tlet syllableCount = 0, wordCount = this.wordCount(text);\n\n\t\ttext.split(/\\s+/).forEach((word) => {\n\t\t\tsyllableCount += this.syllableCount(word);\n\t\t});\n\n\t\t// Prevent NaN...\n\t\treturn (syllableCount||1) / (wordCount||1);\n\t};\n\n\tTextStatistics.prototype.wordsWithThreeSyllables = function(text, countProperNouns) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\tlet longWordCount = 0;\n\n\t\tcountProperNouns = countProperNouns !== false;\n\n\t\ttext.split(/\\s+/).forEach((word) => {\n\n\t\t\t// We don't count proper nouns or capitalised words if the countProperNouns attribute is set.\n\t\t\t// Defaults to true.\n\t\t\tif (!word.match(/^[A-Z]/) || countProperNouns) {\n\t\t\t\tif (this.syllableCount(word) > 2) longWordCount ++;\n\t\t\t}\n\t\t});\n\n\t\treturn longWordCount;\n\t};\n\n\tTextStatistics.prototype.percentageWordsWithThreeSyllables = function(text, countProperNouns) {\n\t\ttext = text ? cleanText(text) : this.text;\n\n\t\treturn (this.wordsWithThreeSyllables(text,countProperNouns) / this.wordCount(text)) * 100;\n\t};\n\n\tTextStatistics.prototype.syllableCount = function(word) {\n\t\tlet syllableCount = 0,\n\t\t\tprefixSuffixCount = 0,\n\t\t\twordPartCount = 0;\n\n\t\t// Prepare word - make lower case and remove non-word characters\n\t\tword = word.toLowerCase().replace(/[^a-z]/g,\"\");\n\n\t\t// Specific common exceptions that don't follow the rule set below are handled individually\n\t\t// Array of problem words (with word as key, syllable count as value)\n\t\tconst problemWords = {\n\t\t\t\"simile\":\t\t3,\n\t\t\t\"forever\":\t\t3,\n\t\t\t\"shoreline\":\t2\n\t\t};\n\n\t\t// Return if we've hit one of those...\n\t\tif (problemWords.hasOwnProperty(word)) return problemWords[word];\n\n\t\t// These syllables would be counted as two but should be one\n\t\tconst subSyllables = [\n\t\t\t/cial/,\n\t\t\t/tia/,\n\t\t\t/cius/,\n\t\t\t/cious/,\n\t\t\t/giu/,\n\t\t\t/ion/,\n\t\t\t/iou/,\n\t\t\t/sia$/,\n\t\t\t/[^aeiuoyt]{2,}ed$/,\n\t\t\t/.ely$/,\n\t\t\t/[cg]h?e[rsd]?$/,\n\t\t\t/rved?$/,\n\t\t\t/[aeiouy][dt]es?$/,\n\t\t\t/[aeiouy][^aeiouydt]e[rsd]?$/,\n\t\t\t/^[dr]e[aeiou][^aeiou]+$/, // Sorts out deal, deign etc\n\t\t\t/[aeiouy]rse$/ // Purse, hearse\n\t\t];\n\n\t\t// These syllables would be counted as one but should be two\n\t\tconst addSyllables = [\n\t\t\t/ia/,\n\t\t\t/riet/,\n\t\t\t/dien/,\n\t\t\t/iu/,\n\t\t\t/io/,\n\t\t\t/ii/,\n\t\t\t/[aeiouym]bl$/,\n\t\t\t/[aeiou]{3}/,\n\t\t\t/^mc/,\n\t\t\t/ism$/,\n\t\t\t/([^aeiouy])\\1l$/,\n\t\t\t/[^l]lien/,\n\t\t\t/^coa[dglx]./,\n\t\t\t/[^gq]ua[^auieo]/,\n\t\t\t/dnt$/,\n\t\t\t/uity$/,\n\t\t\t/ie(r|st)$/\n\t\t];\n\n\t\t// Single syllable prefixes and suffixes\n\t\tconst prefixSuffix = [\n\t\t\t/^un/,\n\t\t\t/^fore/,\n\t\t\t/ly$/,\n\t\t\t/less$/,\n\t\t\t/ful$/,\n\t\t\t/ers?$/,\n\t\t\t/ings?$/\n\t\t];\n\n\t\t// Remove prefixes and suffixes and count how many were taken\n\t\tprefixSuffix.forEach(function(regex) {\n\t\t\tif (word.match(regex)) {\n\t\t\t\tword = word.replace(regex,\"\");\n\t\t\t\tprefixSuffixCount ++;\n\t\t\t}\n\t\t});\n\n\t\twordPartCount = word\n\t\t\t.split(/[^aeiouy]+/ig)\n\t\t\t.filter(function(wordPart) {\n\t\t\t\treturn !!wordPart.replace(/\\s+/ig,\"\").length;\n\t\t\t})\n\t\t\t.length;\n\n\t\t// Get preliminary syllable count...\n\t\tsyllableCount = wordPartCount + prefixSuffixCount;\n\n\t\t// Some syllables do not follow normal rules - check for them\n\t\tsubSyllables.forEach(function(syllable) {\n\t\t\tif (word.match(syllable)) syllableCount --;\n\t\t});\n\n\t\taddSyllables.forEach(function(syllable) {\n\t\t\tif (word.match(syllable)) syllableCount ++;\n\t\t});\n\n\t\treturn syllableCount || 1;\n\t};\n\n\tfunction textStatistics(text) {\n\t\treturn new TextStatistics(text);\n\t}\n\n\t(typeof module != \"undefined\" && module.exports) ? (module.exports = textStatistics) : (typeof define != \"undefined\" ? (define(\"textstatistics\", [], function() { return textStatistics; })) : (glob.TextStatistics = textStatistics)); // jshint ignore:line\n})(SeoField);\n\n// CONSTS / ENUMS\nSeoField.Levels = {\n\tNONE: '',\n\tGOOD: 'good',\n\tOK: 'ok',\n\tBAD: 'bad'\n};\n\nSeoField.Reasons = {\n\ttitleLengthFailMin: 'The title contains {l} characters which is less than the recommended minimum of 40 characters.',\n\ttitleLengthFailMax: 'The title contains {l} characters which is greater than the recommended maximum of 60 characters.',\n\ttitleLengthSuccess: 'The title is between the recommended minimum and maximum length.',\n\n\ttitleKeywordFail: 'The title does not contain the keyword. Try adding it near the beginning of the title.',\n\ttitleKeywordSuccess: 'The title contains the keyword near the beginning.',\n\ttitleKeywordPosFail: 'The title contains the keyword, but not near the beginning. Try to move it closer to the start of the title.',\n\n\tslugFail: 'The URL does not contain the keyword. Try adding it to the slug.',\n\tslugSuccess: 'The URL contains the keyword.',\n\n\tdescFail: 'The description does not contain the keyword. Try adding it near the beginning of the description.',\n\tdescSuccess: 'The description contains the keyword.',\n\n\twordCountFail: 'Your text contains {l} words, this is less than the recommended 300 word minimum.',\n\twordCountSuccess: 'Your text contains {l} words, this is more than the recommended 300 word minimum.',\n\n\tfirstParagraphFail: 'The keyword does not appear in the first paragraph of your text. Try adding it.',\n\tfirstParagraphSuccess: 'The keyword appears in the first paragraph of your text.',\n\n\timagesFail: 'Less than half of the images have alt tags containing the keyword, try adding it to more images.',\n\timagesOk: 'Half or more of the images have alt tags containing the keyword. To improve this, try adding keywords to all the images alt tags.',\n\timagesSuccess: 'All of the images have alt tags containing the keyword.',\n\n\tlinksFail: 'The page does not contain any outgoing links. Try adding some.',\n\tlinksSuccess: 'The page contains outgoing links.',\n\n\theadingsFail: 'The page does not contain any headings that contain the keyword. Try adding some with the keyword.',\n\theadingsOk: 'The page contains some lower importance headings that contain the keyword. Try adding the keyword to some h2\\'s.',\n\theadingsSuccess: 'The page contains higher importance headings with the keyword.',\n\n\tdensityFail: 'The keyword does not appear in the text. It is important to include it in your content.',\n\tdensityFailUnder: 'The keyword density is {d}%, which is well under the advised 2.5%. Try increasing the number of times the keyword is used.',\n\tdensityOk: 'The keyword density is {d}%, which is over the advised 2.5%. The keyword appears {c} times.',\n\tdensitySuccess: 'The keyword density is {d}%, which is near the advised 2.5%.',\n\n\tfleschFail: 'The Flesch Reading ease score is {l} which is considered best for university graduates. Try reducing your sentence length to improve readability.',\n\tfleschOk: 'The Flesch Reading ease score is {l} which is average, and considered easily readable by most users.',\n\tfleschSuccess: 'The Flesch Reading ease score is {l} meaning your content is readable by all ages.',\n};\n"],"names":["SeoField","namespace","hasSection","window","hasSeoField","getElementById","addEventListener","title","slug","desc","getHTMLForParsing","GetEntryHTML","keyword","document","score","list","bar","scoreField","toggle","calculateScore","prototype","this","titleField","t","tInput","titleInput","initial","value","classList","remove","removeEventListener","contains","slugField","s","textContent","adjustHeight","oninput","descField","slice","call","querySelectorAll","forEach","el","Craft","livePreview","on","e","keyCode","preventDefault","replace","length","add","isOpen","getElementsByClassName","style","height","_this5","clientHeight","close","currentScore","titleLength","judgeTitleLength","titleKeyword","judgeTitleKeyword","judgeSlug","judgeDesc","update","content","noContent","Levels","BAD","textOnly","_this6","stats","TextStatistics","wordCount","judgeWordCount","firstParagraph","judgeFirstParagraph","images","judgeImages","links","judgeLinks","headings","judgeHeadings","density","judgeDensity","fleschEase","judgeFleschEase","clean","updateScoreHtml","sorted","sortScore","sortedScore","merged","innerHTML","i","j","reason","good","ok","bad","goodW","okW","badW","transform","v","ret","GOOD","Reasons","titleLengthFailMin","titleLengthFailMax","titleLengthSuccess","index","toLowerCase","indexOf","titleKeywordSuccess","OK","titleKeywordPosFail","titleKeywordFail","log","slugSuccess","slugFail","descSuccess","descFail","wc","wordCountSuccess","wordCountFail","querySelector","firstParagraphSuccess","firstParagraphFail","imgs","getElementsByTagName","imgsWithAltKeyword","getAttribute","imagesSuccess","imagesOk","imagesFail","a","isExternalUrl","href","linksSuccess","linksFail","primary","secondary","nodeName","headingsSuccess","headingsOk","headingsFail","words","keyCount","arr","word","c","keyPercent","parseFloat","toFixed","densityFailUnder","densitySuccess","densityOk","densityFail","level","fleschKincaidReadingEase","fleschSuccess","fleschOk","fleschFail","Fail","message","cp","displayError","console","error","apply","cb","postData","Garnish","getPostData","babelHelpers.typeof","lastPostData","compare","ajax","previewUrl","$","extend","basePostData","data","iframe","contentWindow","open","write","_this7","body","previousElementSibling","removeChild","createElement","setAttribute","width","appendChild","domainRe","res","url","domain","exec","location","unsorted","key","hasOwnProperty","push","concat","glob","cleanText","text","tag","textStatistics","Math","round","averageWordsPerSentence","averageSyllablesPerWord","fleschKincaidGradeLevel","gunningFogScore","percentageWordsWithThreeSyllables","colemanLiauIndex","letterCount","sentenceCount","smogIndex","sqrt","wordsWithThreeSyllables","automatedReadabilityIndex","textLength","split","_words","syllableCount","_this8","countProperNouns","longWordCount","match","_this9","prefixSuffixCount","wordPartCount","problemWords","subSyllables","addSyllables","regex","filter","wordPart","syllable","module","exports","define"],"mappings":"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"}